🔎 Looking for dataset files in: __path__
📂 Loaded dataset: (17328, 1250) (17328,)
🔎 Original class distribution: {np.int64(0): np.int64(1), np.int64(2): np.int64(8951), np.int64(3): np.int64(8376)}
✅ After filtering classes with <2 samples:
   Class distribution: {np.int64(2): np.int64(8951), np.int64(3): np.int64(8376)}
   Total samples remaining: 17327
🏷️ Relabeled classes: {np.int64(2): 0, np.int64(3): 1}
🎯 Training with 2 classes
🔍 Final class check before split: {np.int64(0): np.int64(8951), np.int64(1): np.int64(8376)}
🩺 Applying preprocessing filters (bandpass + notch + wavelet)...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17327/17327 [00:11<00:00, 1447.82it/s] 
📊 Train samples: 14727, Validation samples: 2600
⚡ Using device: cpu
Epoch 1/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:45<00:00, 10.11it/s] 
📊 Epoch 1 | Loss=0.5113 | Val Acc=0.8773
Epoch 2/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:49<00:00,  9.21it/s] 
📊 Epoch 2 | Loss=0.2764 | Val Acc=0.8965
Epoch 3/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:56<00:00,  8.12it/s] 
📊 Epoch 3 | Loss=0.2314 | Val Acc=0.9215
Epoch 4/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:49<00:00,  9.29it/s] 
📊 Epoch 4 | Loss=0.2086 | Val Acc=0.9296
Epoch 5/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:55<00:00,  8.33it/s] 
📊 Epoch 5 | Loss=0.1949 | Val Acc=0.9346
Epoch 6/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:45<00:00, 10.09it/s]
📊 Epoch 6 | Loss=0.1825 | Val Acc=0.9373
Epoch 7/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:54<00:00,  8.40it/s] 
📊 Epoch 7 | Loss=0.1644 | Val Acc=0.9392
Epoch 8/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:46<00:00, 10.00it/s] 
📊 Epoch 8 | Loss=0.1504 | Val Acc=0.9473
Epoch 9/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:48<00:00,  9.41it/s] 
📊 Epoch 9 | Loss=0.1343 | Val Acc=0.9515
Epoch 10/10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 460/460 [00:45<00:00, 10.05it/s]
📊 Epoch 10 | Loss=0.1225 | Val Acc=0.9512
✅ Model saved at model_out/ecg_classifier.pth
✅ Label mapping saved at model_out/label_mapping.npy
🤖 Fuzzy decision for HR=150, Conf=0.9 → 2.00